
<!DOCTYPE html>
<html>
  <head>
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>zutSEO Wykres</title>
	<link href="bootstrap-combined.min.css" rel="stylesheet">

	<style>
		body {background:#eee;}
		.btn {margin:3px;}
		.btn-primary.active {background-color: #036;}
	</style>	
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
	<script type="text/javascript" charset="utf-8" src="cordova-2.2.0.js"></script> 	
	<script type="text/javascript" charset="utf-8" src="seo.js"></script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  
<body onload="onLoad()">

	<div id="menu">  </div>  


<form>
  <input id="example4-b1" type="button" value="Add column and shuffle values"></input>
  <input id="example4-b2" type="button" value="Remove column and shuffle values"></input>
</form>
<div id="example4-visualization"></div>

<script type="text/javascript">


var script=document.createElement('SCRIPT');
script.type='text/javascript';
script.src='http://zszczech.zut.edu.pl/SEO/zapisy/json.php?callback=fooseo&ile=0';
document.getElementsByTagName('head')[0].appendChild(script);	






   function onLoad() {
        document.addEventListener("deviceready", onDeviceReady, false);
		try {if (device.uuid) {}	}
		catch(err) {onDeviceReady();}
    }


    function onDeviceReady() {
		document.addEventListener("menubutton", onMenuKeyDown, false);	
		menu();
    }
	function onMenuKeyDown() {
		document.getElementById("menu").style.display="block";
		menu();
    }	
	








//var skala=1000;
var ffaktor = window.localStorage.getItem('___faktor') || 'search';
	var dane=[];
	var uczelnie=[];
	var daty=[];
	var faktory=[];
	
	function fooseo(res){
		for (var v in res){
			uczelnie.push(v);
		}
		for (var d in res[uczelnie[0]]){
				daty.push(d);
		}
		opisz(res,daty,uczelnie);
		
	}



	function opisz(res,daty,uczelnie){
		var arr=[];
		for (var r in res){
			var obj=res[r];
			arr[r]=[];
			for (var d in obj){
				var dat=obj[d];
				arr[r][d]=dat;
			}			
		}
		// szukaj jakie faktory dla menu
		for (var f in arr[r][d]){faktory.push(f);}
		
		dane.push(uczelnie);

		for (var d in daty){
			var data=daty[d];
			var darr=[];
			darr.push(data);
			for (var u in uczelnie){
				var uczelnia=uczelnie[u];
				darr.push(arr[uczelnia][data][ffaktor]);
			}
			dane.push(darr);
		}
		dane[0].unshift('Time');
	}	
 

	function menu(){
		var menu = document.getElementById('menu');
		for (var m in faktory){
			if (faktory[m]=='ile') continue;
			if (faktory[m]=='faktor') continue;
			var title=nazwa(faktory[m]);
			var klasa=' btn-info';
			if (title.indexOf('zut') >0) var klasa=' btn-primary';
			if (ffaktor==faktory[m]) klasa+=' active';
			var bat  = document.createElement("BUTTON");
			bat.className = 'btn'+klasa;
			bat.setAttribute('onClick','ustaw_faktor("'+faktory[m]+'")');
			bat.innerHTML=title;
			menu.appendChild(bat);
		}
		for (var m in uczelnie){
			if (uczelnie[m]=='Time') continue;
			var title=nazwa(uczelnie[m]);
			var klasa='';
			if (uczelnie[m].indexOf('zut') >=0) var klasa=' btn-inverse';
			if (ffaktor==uczelnie[m]) klasa+=' active';
			var bat  = document.createElement("BUTTON");
			bat.className = 'btn btn-mini'+klasa;
			bat.setAttribute('onClick','ustaw_uczelnie("'+uczelnie[m]+'")');
			bat.innerHTML=title;
			menu.appendChild(bat);
		}
	}



function ustaw_uczelnie(co){
console.log(uczelnie);
	//window.localStorage.setItem('___faktor',co);
	//window.location.reload();
	drawChart();
}	  
	
	
	
function ustaw_faktor(co){
	//window.localStorage.setItem('___faktor',co);
	//window.location.reload();
}	  





//cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
//cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
function drawExample4() {
  var options = {
    width: 640,
    height: 400,
    //vAxis: {minValue:0, maxValue:1000},
    animation: {
      duration: 1000,
      easing: 'out'
    }
  };

  var chart = new google.visualization.LineChart(document.getElementById('example4-visualization'));
  
console.log(dane);
var data = google.visualization.arrayToDataTable(dane);
//console.log(data);


  var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz';
/*  
  var data = new google.visualization.DataTable();
  data.addColumn('string', 'x');
  data.addColumn('number', 'Aa');
  data.addColumn('number', 'Bb');
  data.addColumn('number', 'Cc');
  data.addRow(['2010', 123, 400, 600]);
  data.addRow(['2011', 17, 200, 500]);
  data.addRow(['2012', 170, 200, 50]);
*/
  var addButton = document.getElementById('example4-b1');
  var removeButton = document.getElementById('example4-b2');
  function drawChart() {
    // Disabling the buttons while the chart is drawing.
    addButton.disabled = true;
    removeButton.disabled = true;
    google.visualization.events.addListener(chart, 'ready',
        function() {
          // Enabling only relevant buttons.
          addButton.disabled = (data.getNumberOfColumns() - 1) >= chars.length;
          removeButton.disabled = (data.getNumberOfColumns() - 1) < 2;
        });
    chart.draw(data, options);
  }
  function shuffleAndDrawChart() {
    for (var i = 0; i < data.getNumberOfRows(); ++i) {
      for (var j = 1; j < data.getNumberOfColumns(); ++j) {
        var num = Math.floor(Math.random() * Math.random() * Math.random() * Math.random() * 1000);
        data.setValue(i, j, num);
      }
    }
    drawChart();
  }
  
  addButton.onclick = function() {
    data.addColumn('number', chars[data.getNumberOfColumns() - 1]);
    shuffleAndDrawChart();
  }
  
  removeButton.onclick = function() {
    data.removeColumn(data.getNumberOfColumns() - 1);
    shuffleAndDrawChart();
  }
  drawChart();
}
//cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc

google.load('visualization', '1.1', {packages: ['corechart']});
google.setOnLoadCallback(drawExample4);

</script>

</body>
</html>
